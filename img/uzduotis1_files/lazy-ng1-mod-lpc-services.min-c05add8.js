webpackJsonp([20],{138:function(e,t,n){"use strict";function r(e,t){var n=[];return e.emailsInfo&&e.emailsInfo.forEach(function(e){!e.searchable&&t||n.push({Address:e.address})}),n}function i(e,t){if(t){var n=[];return e.phonesInfo&&e.phonesInfo.forEach(function(e){e.searchable&&n.push({PhoneNumber:e.number,Type:"Home",PhoneUrl:"tel:"+e.number})}),n}var r=[];return e.phones&&e.phones.length>0&&e.phones.forEach(function(e){return r.push({PhoneNumber:e.number,PhoneUrl:"tel:"+e.number,Type:e.type})}),e.telephoneNumber&&r.push({PhoneNumber:e.telephoneNumber,PhoneUrl:"tel:"+e.telephoneNumber,Type:"Business"}),r}function a(e,t){var n=e&&t===c.Federated||!e&&t===c.TflConsumer;return Boolean(n)}var o=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var c,l=n(37);!function(e){e.Federated="Federated",e.SkypeConsumer="SkypeConsumer",e.TflConsumer="TflConsumer"}(c=t.PersonaType||(t.PersonaType={})),t.getDirectReportsAndManager=function(e){return{Managers:e.filter(function(e){return 1===e.managerLevel}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}}),Directs:e.filter(function(e){return!e.userClassification}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}})}},t.getVisibleEmails=function(e){var t=[];return e.emailsInfo&&e.emailsInfo.forEach(function(e){!e.address||e.visibility&&e.visibility!=l.AliasVisibility.Public||t.push({Address:e.address})}),t},t.getVisiblePhones=function(e){var t=[];return e.phonesInfo&&e.phonesInfo.forEach(function(e){!e.number||e.visibility&&e.visibility!=l.AliasVisibility.Public||t.push({PhoneNumber:e.number,Type:"Home",PhoneUrl:"tel:"+e.number})}),t},t.getEmails=r,t.getEmail=function(e,t){if(!t)return e.email?{Address:e.email}:void 0;var n=r(e,t);return n.length>0?n[0]:void 0},t.getPhoneNumbers=i,t.getPhoneNumber=function(e,t){if(t){var n=i(e,t);if(n.length>0){var r=n[0];return{number:r.PhoneNumber,type:r.Type,url:r.PhoneUrl}}}else{if(e.telephoneNumber)return{number:e.telephoneNumber,type:"Business",url:"tel:"+e.telephoneNumber};if(e.phones&&e.phones.length>0){var a=e.phones[0];return{number:a.number,type:a.type,url:"tel:"+a.number}}}},t.removeZeroWidthSpace=function(e){var t=/[\u200B-\u200D\uFEFF]/g;return e.replace(t,"")},t.getPersonaProfileByContactId=function(e,t,n,r,i){return o(this,void 0,void 0,function(){var a,o,c;return s(this,function(s){switch(s.label){case 0:return e?[4,n.getCachedExchangeContactById(e)]:[3,2];case 1:return(o=s.sent())?a=[{displayName:n.getDisplayNameForUserContact(o),id:o.id,jobTitle:o.jobTitle,mri:o.mri,phones:o.phones,email:o.emails[0]||"",objectId:o.id}]:(c="No profile returned for exchange contact",t.error("getCachedExchangeContactById returned no profile in LPC {0}",i),r.fail({reason:c})),[3,3];case 2:c="Empty OlsPersonaId to look for Exchange contact profile",t.error("Empty OlsPersonaId to look for Exchange contact profile in LPC {0}",i),r.fail({reason:c}),s.label=3;case 3:return a&&r.mark(i),[2,a]}})})},t.getIsMixedChatUser=a,t.shouldEnableBlockUnblock=function(e){var t=e.isMe,n=e.isAnonymousUser,r=e.isLoggedInUserConsumer,i=e.personaProfile,o=e.isTfwToTfwFederatedInviteFreeEnabled,s=a(r,i.type);return!(t||n||!r&&!s&&i.type!==c.SkypeConsumer&&(!i.isFederated||!o))}},2356:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2357)},2357:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2358),c=n(37),l=n(320),u=n(2359),p=n(2361),d=n(2362),f=n(2363),h=n(2367),v=function(e){function t(t,n,r,i,a,o,s,c,l,u,p,d,f,h){var v=e.call(this,l)||this;return v.constants=t,v.utilityService=n,v.settingsService=r,v.authenticationService=i,v.sxConfig=a,v.localizationService=o,v.eventingService=s,v.appStateService=c,v.loggingService=u,v.logger=p,v.actionCallbacks=d,v.dataCallbacks=f,v.telemetryCallbacks=h,v.changeTheme=function(e){var t=window.LPC;t&&t.loadTheme(v.getTheme(e))},v.initializeOnAppLaunchAndReinit("First Initialize"),v}return r(t,e),Object.defineProperty(t.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),t.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService"},t.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.lpcPromise=null,window.LPC=null,this.unbsubscribeFromAppStateChanges&&(this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=null)},t.prototype.initializeOnAppLaunchAndReinit=function(e){var t=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,n){t.isLivePersonaCardInitialized&&t.changeTheme(n)}),this.unbsubscribeFromAppStateChanges&&this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=this.eventingService.unsafeOnWithTenantScope(this.constants.events.appState.changed,function(e,n){t.onAppStateChanged(n)})},t.prototype.initializeLPC=function(){return a(this,void 0,void 0,function(){var e,t,n,r,a,c,u,p,d,f,h,v,g,m,b,y,C,S,T,k,P,w,A,I,L,O,E,x,U,M,F,B,D;return o(this,function(o){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];if(e=this.loggingService.newScenario("LivePersonaCard_Initialize"),t=this.utilityService.generateUUID(),n=this.localizationService.getLocale(),r=this.settingsService.getVersion().clientVersion,a=this.settingsService.valueFor(this.constants.settings.names.lpcComplianceEnvironment),c=this.authenticationService.getUserTypeInTenant(),u=this.sxConfig.getCurrentSkypeMri(),p=c===teamspace.services.UserTypeInTenant.Guest,d=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTimeZoneInLPC),f=this.settingsService.valueAsBoolean(this.constants.settings.names.enableExpandedViewInLPC),h=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePronounsInLPC),v=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePeopleHighlightsInLPC),g=this.settingsService.valueAsBoolean(this.constants.settings.names.enableNextAvailabilityInLPC),m=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAliasVisibilitySettings),b=l.isLinkedInEnabled(this.settingsService,this.constants),y=l.isLinkedInPanelEnabled(this.settingsService,this.constants),C=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAnonymousUsersInLPC),S=this.settingsService.valueAsBoolean(this.constants.settings.names.enableExtendedDirectory),T=this.constants.settings.names.lpcRegion,k=this.settingsService.valueFor(T),P=!p&&k,w=P?k:"",!window)throw D="Window object is undefined",e.fail({message:D,clientCorrelationId:t,lpcRegion:w,userTypeInTenant:c}),new Error(D);if(!this.appStateService.isOnline)throw D="App is Offline",e.fail({message:D,clientCorrelationId:t,lpcRegion:w,userTypeInTenant:c}),new Error(D);A=this.getTeamsConfig(t,n,w,a),I=this.settingsService.getRing(),L=this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCardV2),O={isLivePersonaCardV2Enabled:L},E=l.getTimeFormat(this.localizationService),x=E[0],U=E[1],this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+t);try{return M=I&&I.id?I.id:void 0,F=r,this.lpcPromise=s.initializeLivePersonaCardAsync(i(i({},A),{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,telemetryCallbacks:this.telemetryCallbacks,getAuthToken:this.getAuthToken(t),logMessage:function(e,t,n){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+n)},theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:M,hostAppVersion:F,options:{hostAppRing:M,hostAppVersion:F,isLoggedInAsTeamsGuestUser:p,isTimeZoneEnabled:d,isNavigateToExpandedViewEnabled:f,isPronounsEnabled:h,isPeopleHighlightsEnabled:v,isNextAvailabilityEnabled:g,isAliasVisibilityEnabled:m,isLinkedInEnabledInHostApp:b,isLinkedInPanelEnabledInHostApp:y,isAnonymousUsersEnabled:C,isExtendedDirectoryEnabled:S,is24HourFormat:U,timeFormat:x},hostAppConfiguration:O,loggedInUserTeamsMri:u,targetWindow:window})),B=L?"LPCv2":"LPCv1",this.lpcPromise.then(function(){var n=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:n,clientCorrelationId:t,lpcRegion:w,userTypeInTenant:c,lpcArchitectureVersion:B})}).catch(function(n){throw e.fail({message:"Could not load LivePersonaCard",clientCorrelationId:t,lpcRegion:w,userTypeInTenant:c,lpcArchitectureVersion:B}),n}),[2,this.lpcPromise]}catch(n){throw D="Could not load live persona card: "+n,e.fail({message:D,clientCorrelationId:t,lpcRegion:w,userTypeInTenant:c}),new Error(D)}return[2]})})},t.prototype.createLPC=function(e,t){var n=t.profile,r=t.behavior,a=t.ariaLabel,o=t.externalAppSessionCorrelationId,s=t.disableAccessibilityDefaults,c=t.tabIndex,u=t.clientScenario,p=t.isSharedChannel,d=t.hostTenantId,f=t.hostConversationId,h=t.isExchangeOnlyContact,v=t.contactId;{if(this.isLivePersonaCardInitialized){var g=l.determineLPCPersonaType(n.role,n.type),m=l.getCleanUpn(n.userPrincipalName),b={personaInfo:{identifiers:{PersonaType:g,AadObjectId:n.objectId,TeamsMri:n.mri,OlsPersonaId:v,HostAppPersonaId:l.serializeHostAppPersonaId({userId:n.mri,isSharedChannel:p,hostTenantId:d,hostConversationId:f,isExchangeOnlyContact:h}),Upn:m,Smtp:n.email},skypeId:n.skypeId},behavior:i({disableHover:!1,locationToOpen:"Card",cardPlacementMode:"AnchorSide"},r),ariaLabel:a,disableAccessibilityDefaults:!!s,tabIndex:c,externalAppSessionCorrelationId:o,clientScenario:u};this.attachHoverTargetAsync(e,b);var y=function(){window.requestIdleCallback&&window.requestIdleCallback(function(){window.LPC&&window.LPC.removedPersonaFromPage(e)})}.bind(this);return{destroy:function(){y()}}}this.logger.error("Not initialized")}},t.prototype.openCard=function(e,t,n,r,a){if(this.isLivePersonaCardInitialized){var o=this.utilityService.generateUUID(),s={openCardTriggerType:t,personaInfo:{displayName:n.displayName,identifiers:i({PersonaType:"NotResolved"},n.identifiers)},behavior:i({locationToOpen:r,cardPlacementMode:"AnchorSide"},a),externalAppSessionCorrelationId:o};window.LPC.openCard(e,s)}else this.logger.error("Not initialized")},t.prototype.onAppStateChanged=function(e){var t=e.prevState,n=t===teamspace.services.ApplicationState.Offline||t===teamspace.services.ApplicationState.Disconnected||t===teamspace.services.ApplicationState.Disabled,r=this.appStateService.isOnline&&n,i=this.settingsService.valueAsBoolean(this.constants.settings.names.disableLpcOnlineRecovery);r&&!i&&!this.isLivePersonaCardInitialized&&window?(s.freeBootstrapperMemory(window),this.initializeLPC()):this.logger.info("onAppStateChanged: Skip initializeLPC(). isBackOnlineAfterBeingOffline = {0}, disableLpcOnlineRecovery = {1}, this.isLivePersonaCardInitialized = {2}",r,i,this.isLivePersonaCardInitialized)},t.prototype.attachHoverTargetAsync=function(e,t){window.LPC.addedPersonaToPageV2(e,t)},t.prototype.getTheme=function(e){switch(e){case c.TeamsTheme.Dark:case c.TeamsTheme.DarkV2:return f.darkTheme;case c.TeamsTheme.HighContrast:return f.highContrastTheme;case c.TeamsTheme.Default:case c.TeamsTheme.DefaultV2:default:return f.defaultTheme}},t.prototype.getTeamsConfig=function(e,t,n,r){var i=this.authenticationService.isCurrentUserTFLOrMsaAccount();return{culture:t||window.navigator.language||"en-us",region:n,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:r,options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1},isConsumer:i}},t.prototype.getAuthToken=function(e){var t=this;return function(n,r){return a(t,void 0,void 0,function(){var t,i,a,s,c,l,u,p,d,f,h,v,g,m,b,y;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this.constants.settings.names,i=t.lokiTokenResourceUrl,a=t.enableSilentLokiAuthTokenRetrieval,s=this.settingsService.valueAsBoolean(a),[4,this.authenticationService.getAuthTokens([this.settingsService.valueFor(i)],[],s)];case 1:return(c=o.sent())?("string"!=typeof c&&(l=c,u=Boolean(l.token)?"true":"false",this.logger.service.event("lokitoken_format_workaround",{data:"ContainedToken:"+u}),c=null!==(y=l.token)&&void 0!==y?y:""),n(c,e)):r("[AuthError] Error retrieving auth token, details: Empty token",e),[3,3];case 2:return p=o.sent(),this.logger.error("Error acquiring access token for LOKI"),d=!1,f="Unexpected Error",h=void 0,p&&(h=_.isString(p)?p:p.authStatus+"-"+p.message,h=h.toLowerCase()),h&&(v=h.includes("retry fetch of adal tokens"),g=h.includes("nativewam:3")||h.includes("tokenrevoked"),m=h.includes("mt_token_expired")||h.includes("receivedexpiredtoken"),b=h.includes("renewaltimeout")||h.includes("token renewal"),d=v||b||m||g,v?f="Retry fetch of ADAL tokens failed":b?f="Token renewal call timed out":g?f="Token revoked":m&&(f="Token expired")),r("[AuthError] Error retrieving auth token, details: "+f,e,d),[3,3];case 3:return[2]}})})}},t}(teamspace.services.MTMABase);t.LivePersonaCardService=v,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.dialogService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsAsyncService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService","teamspace.extendedDirectoryOnlyPolicyService"]).factory("lpcService",["constants","callingPolicyStore","messagingPolicySettingsStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsAsyncService","localizationService","eventingService","messageService","peopleService","dialogService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService","callBlockingService","appStateService","sxConfig","routeUtilityService","messagingPolicyUtilsService","flatContactListService","telemetryProvider","chatListService","tenantSettingsStore","extendedDirectoryOnlyPolicyService",function(e,t,n,r,i,a,o,s,c,l,f,g,m,b,y,C,S,T,k,P,w,A,I,L,O,E,x,U,M,F,B,D,_,j,N,R,H){var G=a.newLogger("LivePersonaCardService"),V=new h.LpcTelemetryHelper(x,a,l),X=V.logPanelActionEvent.bind(V),z=o.getUserTypeInTenant(),W=u.LPCActionCallbackFactory(s,e,G,b,l,o,c,C,m,U,y,i,N,X,F),q=p.LPCDataCallbackFactory(G,l,S,b,r,T,k,i,e,P,w,A,I,L,f,O,U,t,n,z,F,o,B,D,_,R,H),Q=i.valueAsBoolean(e.settings.names.enableLpcSecondPartyTelemetry)?d.LPCTelemetryCallbackFactory(j):void 0;return new v(e,r,i,o,F,f,g,M,E,a,G,W,q,Q)}])},2358:function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){function t(t){for(var n,r,a=t[0],o=t[1],s=0,l=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);l.length;)l.shift()()}function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var r={},i={1:0};n.e=function(e){var t=[],r=i[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise(function(t,n){r=i[e]=[t,n]});t.push(r[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+""+({0:"loggingdependencies",2:"vendors~loggingdependencies"}[e]||e)+"_"+{0:"eeaf5054efb9906dbd01",2:"9b58d17e7df24871a7d5"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",c.name="ChunkLoadError",c.type=r,c.request=a,n[1](c)}i[e]=void 0}};var l=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=r,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://res-1.cdn.office.net/midgard/versionless/",n.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var c=o;return n(n.s=16)}([function(e,t,n){"use strict";function r(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})}function i(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!((a=a.length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return i});var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.create,Object.create},function(e,t,n){"use strict";t.a={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"}},function(e,t,n){"use strict";var r=n(4),i="object"==typeof self&&self&&self.Object===Object&&self,a=r.a||i||Function("return this")();t.a=a},function(e,t,n){"use strict";function r(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}function i(e){return!function(e){return!e||"00000000-0000-0000-0000-000000000000"===e}(e)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e||"")}function a(){for(var e=r(),t=0,n="",i=0;i<36;i++)switch(i){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[i-t]%4+8).toString(16);break;default:n+=(e[i-t]%16).toString(16)}return n}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a})},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(15))},function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e){return a.indexOf(e)>-1}function i(e){return-1===o.indexOf(e)}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var a=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus","OfficeFeedVerbose"],o=["Stikkontakt","DataLoadStartAction","NoLogging","None"]},function(e,t,n){"use strict";t.a={CLIENT_TIMESTAMP:"ClientTimeStamp",TRANSACTION_ID:"QoSTransactionId",SOURCE_CORRELATION_ID:"SourceCorrelationId"}},function(e,n,r){"use strict";(function(e){var i=r(4),a="object"==typeof t&&t&&!t.nodeType&&t,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===a&&i.a.process,c=function(){try{return o&&o.require&&o.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();n.a=c}).call(this,r(11)(e))},function(e,t,n){"use strict";function r(e,t){return e.hasOwnProperty(t)}n.d(t,"a",function(){return r});var i,a=n(2),o=a.a.Symbol,s=Object.prototype,c=s.hasOwnProperty,l=s.toString,u=o?o.toStringTag:void 0,p=function(e){var t=c.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var i=l.call(e);return r&&(t?e[u]=n:delete e[u]),i},d=Object.prototype.toString,f=function(e){return d.call(e)},h=o?o.toStringTag:void 0,v=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":h&&h in Object(e)?p(e):f(e)},g=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},m=function(e){if(!g(e))return!1;var t=v(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},b=a.a["__core-js_shared__"],y=(i=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",C=function(e){return!!y&&y in e},S=Function.prototype.toString,T=function(e){if(null!=e){try{return S.call(e)}catch(e){}try{return e+""}catch(e){}}return""},k=/^\[object .+?Constructor\]$/,P=Function.prototype,w=Object.prototype,A=P.toString,I=w.hasOwnProperty,L=RegExp("^"+A.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),O=function(e){return!(!g(e)||C(e))&&(m(e)?L:k).test(T(e))},E=function(e,t){return null==e?void 0:e[t]},x=function(e,t){var n=E(e,t);return O(n)?n:void 0},U=function(){try{var e=x(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),M=function(e,t,n){"__proto__"==t&&U?U(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},F=function(e,t){return e===t||e!=e&&t!=t},B=Object.prototype.hasOwnProperty,D=function(e,t,n){var r=e[t];B.call(e,t)&&F(r,n)&&(void 0!==n||t in e)||M(e,t,n)},_=function(e,t,n,r){var i=!n;n||(n={});for(var a=-1,o=t.length;++a<o;){var s=t[a],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?M(n,s,c):D(n,s,c)}return n},j=function(e){return e},N=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},R=Math.max,H=function(e,t,n){return t=R(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=R(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),N(e,this,s)}},G=function(e){return function(){return e}},V=U?function(e,t){return U(e,"toString",{configurable:!0,enumerable:!1,value:G(t),writable:!0})}:j,X=Date.now,z=function(e){var t=0,n=0;return function(){var r=X(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(V),W=function(e,t){return z(H(e,t,j),e+"")},q=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Q=function(e){return null!=e&&q(e.length)&&!m(e)},K=/^(?:0|[1-9]\d*)$/,J=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&K.test(e))&&e>-1&&e%1==0&&e<t},$=function(e,t,n){if(!g(n))return!1;var r=typeof t;return!!("number"==r?Q(n)&&J(t,n.length):"string"==r&&t in n)&&F(n[t],e)},Z=Object.prototype,Y=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Z)},ee=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},te=function(e){return null!=e&&"object"==typeof e},ne=function(e){return te(e)&&"[object Arguments]"==v(e)},re=Object.prototype,ie=re.hasOwnProperty,ae=re.propertyIsEnumerable,oe=ne(function(){return arguments}())?ne:function(e){return te(e)&&ie.call(e,"callee")&&!ae.call(e,"callee")},se=Array.isArray,ce=n(12),le={};le["[object Float32Array]"]=le["[object Float64Array]"]=le["[object Int8Array]"]=le["[object Int16Array]"]=le["[object Int32Array]"]=le["[object Uint8Array]"]=le["[object Uint8ClampedArray]"]=le["[object Uint16Array]"]=le["[object Uint32Array]"]=!0,le["[object Arguments]"]=le["[object Array]"]=le["[object ArrayBuffer]"]=le["[object Boolean]"]=le["[object DataView]"]=le["[object Date]"]=le["[object Error]"]=le["[object Function]"]=le["[object Map]"]=le["[object Number]"]=le["[object Object]"]=le["[object RegExp]"]=le["[object Set]"]=le["[object String]"]=le["[object WeakMap]"]=!1;var ue=n(8),pe=ue.a&&ue.a.isTypedArray,de=pe?function(e){return function(t){return e(t)}}(pe):function(e){return te(e)&&q(e.length)&&!!le[v(e)]},fe=Object.prototype.hasOwnProperty,he=function(e,t){var n=se(e),r=!n&&oe(e),i=!n&&!r&&Object(ce.a)(e),a=!n&&!r&&!i&&de(e),o=n||r||i||a,s=o?ee(e.length,String):[],c=s.length;for(var l in e)!t&&!fe.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||J(l,c))||s.push(l);return s},ve=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),ge=Object.prototype.hasOwnProperty,me=function(e){if(!Y(e))return ve(e);var t=[];for(var n in Object(e))ge.call(e,n)&&"constructor"!=n&&t.push(n);return t},be=function(e){return Q(e)?he(e):me(e)},ye=Object.prototype.hasOwnProperty;!function(e){W(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,o&&$(n[0],n[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t})}(function(e,t){if(Y(t)||Q(t))_(t,be(t),e);else for(var n in t)ye.call(t,n)&&D(e,n,t[n])})},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="Unknown"},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,n,r){"use strict";(function(e){var i=r(2),a=r(13),o="object"==typeof t&&t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,c=s&&s.exports===o?i.a.Buffer:void 0,l=(c?c.isBuffer:void 0)||a.a;n.a=l}).call(this,r(11)(e))},function(e,t,n){"use strict";t.a=function(){return!1}},,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}function i(e,t,n){return new Promise(function(i,a){e?(r("LokiAuthToken",e,n),i(e)):t(function(e,t){e?(r("LokiAuthToken",e,n),i(e)):a(new E("GetAuthTokenError","Auth token is undefined",t))},function(e,t,n){var r=function(e,t){var n=/^AADSTS\d+?:/.test(e),r=function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,t);return n||r}(e,n)?e:"";a(new E("GetAuthTokenError",r,t,n))})})}function a(e,t){var n=function(e){return"df"===e?O.Dogfood:"msit"===e?O.MSIT:void 0}(e);return n||(n=function(e){switch(e){case"Df":return O.Dogfood;case"Msit":return O.MSIT;case"Blackforest":return O.Blackforest;case"GccModerate":return O.GccModerate;case"GccHigh":return O.GccHigh;case"DoD":return O.DOD;case"Gallatin":return O.Gallatin;case"Prod":return O.TopLevel;case"AG08":return O.AG08;case"AG09":return O.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(x.a)(e)}}(t)),n}function o(e,t){void 0===t&&(t=window);var n="";if(t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search);n=r&&t.decodeURIComponent(r[1].replace(/\+/g," "))||""}return n}function s(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}function c(e,t,n){var r,i,o,c,l=s("LivePersonaCardCultureOverride",n),u=(r=t.region,i=t.complianceEnvironment,o=l||t.culture,c=a(r,i),"{0}/api/v1/livepersonacard/configuration?cultureName={1}".replace("{0}",c).replace("{1}",o));return D(u,e,_(_({},t),{clientFeature:"LivePersonaCard"}),n)}function l(e,t,n){var r=function(e,t){var n=t||e.culture,r=a(e.region,e.complianceEnvironment);return"{0}/api/v1/livepersonaeditor/configuration?cultureName={1}".replace("{0}",r).replace("{1}",n)}(t,s("LivePersonaEditorCultureOverride",n));return D(r,e,_(_({},t),{clientFeature:"LivePersonaEditor"}),n)}function u(e){var t=e.targetWindow||window,n=X.get(t);return n?n.bootstrapperConfig=V(V({},n.bootstrapperConfig),e):n={bootstrapperConfig:V(V({},e),{targetWindow:t}),ariaLogger:new G(e),initializationPromise:void 0,lpeInitializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshLpeInitializationPromise:!1,forceRefreshInitializationTimeout:void 0},X.set(t,n),n}function p(e,t,n){return z(this,void 0,void 0,function(){var r,i;return W(this,function(a){switch(a.label){case 0:return(i=u(t)).lpcConfig?(r=i.lpcConfig,[3,3]):[3,1];case 1:return[4,d(e,t,n)];case 2:r=a.sent(),i.lpcConfig=r,a.label=3;case 3:return[2,r]}})})}function d(e,t,n){return z(this,void 0,void 0,function(){var r,a;return W(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,c(e,t,n)];case 1:return r=o.sent(),[3,8];case 2:return(a=o.sent()).statusCode&&401===a.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return q<2?(q++,[4,d(e,t,n)]):[3,6];case 5:return r=o.sent(),[3,7];case 6:throw a.numberOfRetries=q,a;case 7:return[3,8];case 8:return[2,r]}})})}function f(e,t){var n=this,r=0,i=function(e,t){return Q(n,void 0,void 0,function(){var n;return K(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,6]),[4,h(e,t)];case 1:return a.sent(),[3,6];case 2:return n=a.sent(),r<2?(r++,[4,i(e,t)]):[3,4];case 3:return a.sent(),[3,5];case 4:throw n.numberOfRetries=r,n;case 5:return[3,6];case 6:return[2]}})})};return i(e,t)}function h(e,t){return new Promise(function(n,r){var i=t.document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.setAttribute("data-is-midgard-bootstrapper-script",""),i.crossOrigin="anonymous",i.src=e,i.addEventListener("load",function(){n()}),i.addEventListener("error",function(){r(new E("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(i)})}function v(e,t){var n=e.ResourceUrls||[];if(0===n.length){var r=e.Resources.livepersonacardstrings,i=e.Resources["livepersonacard_with-react"];"OwaPeopleHub"===e.Workload&&(i=e.Resources["livepersonacard_without-react"]),n=[r,i]}return Promise.all(n.map(function(e){return f(e,t)})).then(function(){return n})}function g(e,t){var n=this,r=t.targetWindow;return new Promise(function(i,a){setTimeout(function(){return J(n,void 0,void 0,function(){var n,o;return $(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),r.LPC||a(new E("StartLivePersonaCardError","targetWindow.LPC is undefined.")),r.LivePersonaCardStrings&&r.LivePersonaCardStrings.strings||r.LivePersonaCardStringsLpcMini&&r.LivePersonaCardStringsLpcMini.strings||a(new E("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined.")),n=function(e,t){var n=t.targetWindow;return{accountId:t.accountId,refreshAuthToken:(r=t.getAuthToken,function(e){r(function(t,n){e(t,"",n,void 0)},function(t,n){e("",t,n,void 0)})}),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId&&Object(F.b)(t.clientCorrelationId)?t.clientCorrelationId:"00000000-0000-0000-0000-000000000000",activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,telemetryCallbacks:t.telemetryCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,setConfigurationManagerForTesting:t.setConfigurationManagerForTesting,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName,app:t.app,platform:t.platform};var r}(e,t),[4,r.LPC.start(n)];case 1:return s.sent(),i(),[3,3];case 2:return o=s.sent(),a(new E("StartLivePersonaCardError",o.name)),[3,3];case 3:return[2]}})})},0)})}function m(e){switch(e.complianceEnvironment){case"Blackforest":return"e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193";case"GccHigh":return"e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057";case"DoD":return"e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359";case"Gallatin":return"e5ad760145754ffc9704e67c800087f2-e2685720-0f91-4c64-acd6-32359f3b1c29-6998";case"AG08":case"AG09":return"";case"GccModerate":case"Prod":default:return"e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257"}}function b(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}function y(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}function C(e){return void 0===e||"string"!=typeof e||""===e||null===e}function S(e){return void 0===e||"function"!=typeof e}function T(e){var t="";if(e){var n=[];C(e.culture)&&n.push("culture"),C(e.clientType)&&n.push("clientType"),C(e.clientContextType)&&n.push("clientContextType"),C(e.clientCorrelationId)&&n.push("clientCorrelationId"),S(e.logMessage)&&n.push("logMessage"),S(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): ".concat(n.join(", "),". Check the values and types you're passing. ")),e.region&&-1===Y.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, "+"and ".concat(Y.join(", ")," for pre-production environments. ")),-1===ee.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: ".concat(ee.join(", "),". We currently don't support other Sovereign Clouds."))}else t="Config must be defined.";if(t)throw new E("ValidateBootstrapperConfigError",t)}function k(e,t,n){return te(this,void 0,void 0,function(){var r,i;return ne(this,function(a){switch(a.label){case 0:return(i=u(t)).lpeConfig?(r=i.lpeConfig,[3,3]):[3,1];case 1:return[4,P(e,t,n)];case 2:r=a.sent(),i.lpeConfig=r,a.label=3;case 3:return[2,r]}})})}function P(e,t,n){return te(this,void 0,void 0,function(){var r,a;return ne(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,l(e,t,n)];case 1:return r=o.sent(),[3,8];case 2:return(a=o.sent()).statusCode&&401===a.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return re<2?(re++,[4,k(e,t,n)]):[3,6];case 5:return r=o.sent(),[3,7];case 6:throw a.numberOfRetries=re,a;case 7:return[3,8];case 8:return[2,r]}})})}function w(e){return ae(this,void 0,void 0,function(){var t,n,r,a=this;return oe(this,function(o){return t=new Z(window),n=u(e),r=function(){return u(e).ariaLogger},!n.forceRefreshLpeInitializationPromise&&n.lpeInitializationPromise||(n.lpeInitializationPromise=new Promise(function(n,o){return ae(a,void 0,void 0,function(){var a,s,c,l,u,p;return oe(this,function(d){switch(d.label){case 0:a=m(e),d.label=1;case 1:return d.trys.push([1,6,,7]),T(e),t.startCustomTiming(M.getAuthToken),[4,i(e.authToken,e.getAuthToken,window)];case 2:return s=d.sent(),t.endCustomTiming(M.getAuthToken),t.measureFromStart(M.getAuthTokenFromStart),t.startCustomTiming(M.getLokiConfig),[4,k(s,e,window)];case 3:return c=d.sent(),t.endCustomTiming(M.getLokiConfig),t.measureFromStart(M.getLokiConfigFromStart),t.startCustomTiming(M.getLpeBundles),[4,(h=c,v=window,g=[h.Resources.livepersonaeditorstrings,h.Flights.indexOf("withreact")>-1?h.Resources["livepersonaeditor_with-react"]:h.Resources["livepersonaeditor_without-react"]],Promise.all(g.map(function(e){return f(e,v)})).then(function(){return g}))];case 4:return d.sent(),t.endCustomTiming(M.getLpeBundles),t.measureFromStart(M.getLpeBundlesFromStart),[4,r().updateContextWithLokiDataAsync(c,a).catch(function(){console.log("Live Persona Editor ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 5:return d.sent(),(l=y(t.getAllTimings())).RootCorrelationId=c.RootCorrelationId,l.isConsumer=e.isConsumer,r().logEventAsync({name:"initializeLivePersonaEditor_success",properties:l},a),n(c),[3,7];case 6:return u=d.sent(),p=y(t.getAllTimings()),r().logEventAsync({name:"initializeLivePersonaEditor_failure",properties:ie(ie(ie({},b(u)),p),{isConsumer:e.isConsumer})},a),o("Failed to initialize Live Persona Editor: ".concat(u.name," ").concat(u.message)),[3,7];case 7:return[2]}var h,v,g})})}),n.lpeInitializationPromise.catch(function(){setTimeout(function(){n.forceRefreshLpeInitializationPromise=!0},3e5)})),[2,n.lpeInitializationPromise]})})}function A(e){return ce(this,void 0,void 0,function(){var t,n,r,a,o=this;return le(this,function(s){return t=u(e),n=function(){return u(e).ariaLogger},!t.forceRefreshInitializationPromise&&t.initializationPromise||(r=t.bootstrapperConfig.targetWindow,a=new Z(r),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(s,c){return ce(o,void 0,void 0,function(){var o,l,u,d,f,h;return le(this,function(C){switch(C.label){case 0:o=m(e),C.label=1;case 1:return C.trys.push([1,7,,8]),T(e),a.startCustomTiming(M.getAuthToken),[4,i(e.authToken,e.getAuthToken,r)];case 2:return l=C.sent(),a.endCustomTiming(M.getAuthToken),a.measureFromStart(M.getAuthTokenFromStart),a.startCustomTiming(M.getLokiConfig),[4,p(l,e,r)];case 3:return u=C.sent(),a.endCustomTiming(M.getLokiConfig),a.measureFromStart(M.getLokiConfigFromStart),a.startCustomTiming(M.getLpcBundles),[4,v(u,r)];case 4:return C.sent(),a.endCustomTiming(M.getLpcBundles),a.measureFromStart(M.getLpcBundlesFromStart),a.startCustomTiming(M.startLpc),[4,g(u,t.bootstrapperConfig)];case 5:return C.sent(),a.endCustomTiming(M.startLpc),a.measureFromStart(M.startLpcFromStart),[4,n().updateContextWithLokiDataAsync(u,o).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return C.sent(),(d=y(a.getAllTimings())).RootCorrelationId=u.RootCorrelationId,d.isConsumer=e.isConsumer,n().logEventAsync({name:"initializeLivePersonaCard_success",properties:d},o),s(),[3,8];case 7:return f=C.sent(),h=y(a.getAllTimings()),n().logEventAsync({name:"initializeLivePersonaCard_failure",properties:se(se(se({},b(f)),h),{isConsumer:e.isConsumer})},o),c("Failed to initialize Live Persona Card: ".concat(f.name," ").concat(f.message)),[3,8];case 8:return[2]}})})}),t.initializationPromise.catch(function(){t.forceRefreshInitializationTimeout=window.setTimeout(function(){t&&(t.forceRefreshInitializationPromise=!0)},3e5)})),[2,t.initializationPromise]})})}function I(e){!function(e){var t=X.get(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing,delete n.LPE),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig,clearTimeout(t.forceRefreshInitializationTimeout)}X.delete(e)}(e);try{e.document.querySelectorAll("script[".concat("data-is-midgard-bootstrapper-script","]")).forEach(function(e){return e.remove()})}catch(e){console.warn("midgard-bootstrapper:freeBootstrapperMemory(): Failed removing one or more script tags")}}function L(e){return ce(this,void 0,void 0,function(){var t;return le(this,function(n){switch(n.label){case 0:return t=u(e),[4,i(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,p(n.sent(),e,t.bootstrapperConfig.targetWindow)]}})})}n.r(t),n.d(t,"initializeLivePersonaEditorAsync",function(){return w}),n.d(t,"initializeLivePersonaCardAsync",function(){return A}),n.d(t,"freeBootstrapperMemory",function(){return I}),n.d(t,"fetchLokiConfigAsync",function(){return L});var O,E=function(e,t,n,r,i,a){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=i,this.numberOfRetries=a},x=n(5);!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(O||(O={}));n(0);var U,M,F=n(3),B=function(e,t,n,r,i,a){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=i,this.numberOfRetries=a},D=function(e,t,n,r,i,a,s){return void 0===i&&(i={}),void 0===a&&(a=6e4),new Promise(function(c,l){var u,p=new XMLHttpRequest,d=function(e,t){var n=o("ClientTypeOverride",t)||e.clientType,r=o("MidgardOnlyOverrideCatalog",t),i=o("HostAppConfiguration",t),a=o("MidgardVersion",t);return{clientTypeOverride:n,hostAppConfigurationQSP:i,versionOverride:(r?"":a)||o("LivePersonaCardVersionOverride",t),lpeVersionOverride:(r?"":a)||o("LivePersonaEditorVersionOverride",t),lpeBranchOverride:o("LivePersonaEditorBranchOverride",t),midgardBranchOverride:r?"":o("MidgardBranch",t)}}(n,r),f=d.clientTypeOverride,h=d.hostAppConfigurationQSP,v=d.versionOverride,g=d.lpeVersionOverride,m=d.lpeBranchOverride,b=d.midgardBranchOverride;p.open("GET",e,!0),p.setRequestHeader("Authorization","Bearer "+t),p.setRequestHeader("Accept","application/json");var y=null!==(u=i.requestId)&&void 0!==u?u:Object(F.a)();if(p.setRequestHeader("X-RootCorrelationId",y),p.setRequestHeader("X-CorrelationId",y),p.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),p.setRequestHeader("X-ClientFeature",n.clientFeature),p.setRequestHeader("X-ClientArchitectureVersion","v2"),p.setRequestHeader("X-ClientScenario","GetConfiguration"),s&&p.setRequestHeader("X-LPCVersion",s),f&&p.setRequestHeader("X-ClientType",f),n.app&&p.setRequestHeader("X-HostAppApp",n.app),n.platform&&p.setRequestHeader("X-HostAppPlatform",n.platform),n.hostAppRing&&p.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&p.setRequestHeader("X-HostAppVersion",n.hostAppVersion),n.hostAppConfiguration&&p.setRequestHeader("X-HostAppConfiguration",JSON.stringify(n.hostAppConfiguration)),h){var C={};h.split(";").forEach(function(e){var t=e.split(":"),n=t[0],r=t[1];C[n]=r}),p.setRequestHeader("HostAppConfiguration",JSON.stringify(C))}r&&r.React&&r.React.version&&r.ReactDOM&&p.setRequestHeader("X-HostAppReactVersion",r.React.version),v&&(p.setRequestHeader("LivePersonaCardVersionOverride",v),p.setRequestHeader("MidgardVersion",v)),g&&p.setRequestHeader("X-".concat("LivePersonaEditorVersionOverride"),g),m&&p.setRequestHeader("X-".concat("LivePersonaEditorBranchOverride"),m),b&&(p.setRequestHeader("MidgardBranch",b),p.setRequestHeader("X-".concat("MidgardBranch"),b)),p.addEventListener("load",function(){if(200===p.status)try{var e=JSON.parse(p.response);e.RootCorrelationId=y,e.LokiVersion=p.getResponseHeader("x-serverversion")||"",c(e)}catch(e){l(new B("GetLokiConfigError","Failed to parse initialization config.",y))}else l(new B("GetLokiConfigError","Couldn't retrieve initialization config. Status code is ".concat(p.status),y,!1,p.status))}),p.addEventListener("error",function(){l(new B("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",y))}),p.addEventListener("timeout",function(){l(new B("GetLokiConfigError","Loki config request timed out after ".concat(a," ms."),y))}),p.timeout=a,p.send()})},_=function(){return(_=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},j=(n(21),function(){return Promise.all([n.e(2),n.e(0)]).then(n.bind(null,56))}),N=function(){return j().then(function(e){return e.AWTLogManager})},R=(U=function(){return j().then(function(e){return e.Logger})},function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})}),H=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!((a=a.length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},G=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return R(this,void 0,void 0,function(){return H(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,N()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return R(this,void 0,void 0,function(){var n;return H(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),n.setContext("flights",e.Flights.join(",")),n.setContext("settings",JSON.stringify(e.Settings)),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return R(this,void 0,void 0,function(){var t,n,r;return H(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,N()];case 1:return n=i.sent(),[4,this.getCollectorUrlAsync()];case 2:r=i.sent(),(t=n.initialize(e,{collectorUri:r,disableCookiesUsage:!0}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),this.bootstrapperConfig.app&&t.setContext("app",this.bootstrapperConfig.app),this.bootstrapperConfig.platform&&t.setContext("platform",this.bootstrapperConfig.platform),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20220614.8.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getCollectorUrlAsync=function(){return R(this,void 0,void 0,function(){return H(this,function(e){switch(this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,"https://de.pipe.aria.microsoft.com/Collector/3.0/"];case"GccHigh":return[2,"https://tb.pipe.aria.microsoft.com/Collector/3.0"];case"DoD":return[2,"https://pf.pipe.aria.microsoft.com/Collector/3.0"];case"AG08":case"AG09":return[2,""];case"Gallatin":case"GccModerate":case"Prod":default:return[2,void 0]}return[2]})})},e.prototype.noOp=function(){},e}(),V=function(){return(V=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},X=new WeakMap,z=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},W=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!((a=a.length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},q=0,Q=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},K=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!((a=a.length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},J=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},$=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!((a=a.length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o};!function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getLpeBundles="GetLpeBundlesDuration",e.getLpeBundlesFromStart="GetLpeBundlesFromStartDuration"}(M||(M={}));var Z=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-start"))}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-end")),this.targetWindow.performance.measure(e,"".concat(e,"-start"),"".concat(e,"-end"));var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")||-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}(),Y=["msit","df","ppe"],ee=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09"],te=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},ne=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!((a=a.length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},re=0,ie=function(){return(ie=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ae=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},oe=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!((a=a.length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},se=function(){return(se=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ce=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},le=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!((a=a.length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o};try{var ue=window.document.createElement("link"),pe=Boolean("onmscontentzoom"in window.document);ue.rel=pe?"dns-prefetch":"preconnect",ue.href="https://res-1.cdn.office.net/",window.document.head.appendChild(ue)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}},function(e,t,n){"use strict";function r(e){return"object"==typeof e&&!!e&&Object(i.a)(e,"family")&&Object(i.a)(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}n.d(t,"a",function(){return r});var i=n(9)},,,,function(e,t,n){"use strict";var r=n(0),i=n(3),a=n(17),o=n(10),s=n(7),c=n(1),l=n(6),u=function(){function e(e,t,n,r,a,o,s){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=n,this.featureName=r,this.staticProperties=a,this.lookupError=o,this.isVerboseLoggingEnabled=s,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=c.a.MONITOR_IN_INVALID_STATE,this.transactionId=Object(i.a)(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then(function(e){return e.broadcastFlush()})},e.prototype.success=function(e,t){this.endEvent(e,c.a.SUCCESS,t)},e.prototype.expectedFailure=function(e,t){this.endEvent(e,c.a.EXPECTED_FAILURE,t)},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,c.a.UNEXPECTED_FAILURE,t)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,c.a.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=(new Date).getTime()},e.prototype.endEvent=function(e,t,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=(new Date).getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=c.a.MONITOR_IN_INVALID_STATE,this.lastTag=e,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(e,t,n){return Object(r.b)(this,void 0,void 0,function(){var i,s,c,u,p,d;return Object(r.c)(this,function(r){switch(r.label){case 0:return!Object(l.a)(this.featureName)||Object(l.b)(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(i=e?"".concat(this.scenarioName,"_").concat(t,"_").concat(e):"".concat(this.scenarioName,"_").concat(t),[4,this.eventHubPromise]):[3,5];case 1:return s=r.sent(),u=(c=s).broadcastEvent,d={eventId:i,version:this.monitoringData.version?this.monitoringData.version:o.a,type:"QoS"},n&&Object(a.a)(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return p=r.sent(),[3,4];case 3:p=void 0,r.label=4;case 4:u.apply(c,[(d.midgardError=p,d.source=this.monitoringData.source,d.featureName=this.featureName,d.clientCorrelationid=this.monitoringData.clientCorrelationId,d.qosScenarioName=this.scenarioName,d.qosEventType=t,d.qosTagId=null===e?void 0:e,d.duration=this.duration,d.properties=this.getProperties(n),d)]),r.label=5;case 5:return[2]}})})},e.prototype.getProperties=function(e){var t;return Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({},e),((t={})[s.a.CLIENT_TIMESTAMP]=(new Date).getTime().toString(),t[s.a.TRANSACTION_ID]=this.transactionId,t)),this.monitoringData.properties),this.staticProperties())},e}();t.a=u}])})},2359:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var o=n(37),s=n(138),c=n(2360),l=function(e,t,n){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return n.navigatePromise(t,e.states.appConversation,i)}},u=function(e,t){return function(n,r){return void 0===r&&(r=!1),i(void 0,void 0,void 0,function(){var i,o,s;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.getChatConversationWith(n)];case 1:if(!(i=a.sent()))throw"Invalid chat conversation.";return[3,3];case 2:return o=a.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(o),[2,Promise.reject("_placeCall(): Failed to find chat conversation with error "+s)];case 3:return[2,t.placeCall({conversationId:i.id,withVideo:r,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]}})})}},p=function(e,t){return function(n,r){return i(void 0,void 0,void 0,function(){var i,o,s,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.getChatConversationWith(n)];case 1:if(!(i=a.sent()))throw"Invalid chat conversation";return[3,3];case 2:return o=a.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(o),[2,Promise.reject("_sendMessage(): Cannot find the chat with error "+s)];case 3:return c=SkypeX.Services.Utilities.newClientMessageId(),[2,t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:c,externalId:null,draftObjectId:null,inlineImages:null})]}})})}},d=function(e,t,n,c,l,u,p){return function(d,f){var h=d.persona;return i(void 0,void 0,void 0,function(){var i,d,v,g,m,b,y,C;return a(this,function(a){switch(a.label){case 0:t.info("LPC::Starting chat"),a.label=1;case 1:return a.trys.push([1,5,,6]),i=n.getFreshnessInMs(),d=e.scenarios.people.lpcStartChat,[4,n.getAllPeopleProfile([h.TeamsMri],d,!1,!1,i)];case 2:return v=a.sent()[0],g=l.isCurrentUserTFLOrMsaAccount(),(m=s.getIsMixedChatUser(g,v.type))&&v.type===e.userTypes.tflConsumer&&(v=r(r({},v),{mri:h.TeamsMri.replace("8:","8:tfl:")})),[4,c.getConversationWithV2(v.mri,d)];case 3:return b=a.sent(),[4,u({groupName:v.displayName,peopleSlug:b.id,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 4:return a.sent(),f(!0),p(o.LpcCallbackTelemetryType.lpcStartChat,v.mri),[3,6];case 5:return y=a.sent(),C="Failed to navigate to chat",t.error(C),f(!1,C),[3,6];case 6:return[2]}})})}},f=function(e,t,n,r,s,c){return function(l,u){return i(void 0,void 0,void 0,function(){var i,p,d,f,h,v;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),t.info("LPC::Navigating to user's org chart"),i=n.getFreshnessInMs(),p=e.scenarios.people.lpcOrgChart,(d=l.TeamsMri)!==c.getCurrentSkypeMri()?[3,2]:[4,r({slug:SkypeX.Services.ChatServiceUtils.SelfChatConversationId,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 1:return a.sent(),[3,5];case 2:return[4,n.getAllPeopleProfile([d],p,!1,!1,i)];case 3:return f=a.sent()[0],[4,r({groupName:f.displayName,slug:d,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 4:a.sent(),a.label=5;case 5:return u(!0),s(o.LpcCallbackTelemetryType.lpcOrgChart,d),[3,7];case 6:return h=a.sent(),v="Failed to navigate to org chat",t.error(v),u(!1,v),[3,7];case 7:return[2]}})})}},h=function(e,t,n,r,s,c){return function(l,u){return i(void 0,void 0,void 0,function(){var i,p,d,f,h,v;return a(this,function(a){switch(a.label){case 0:i=l.TeamsMri,a.label=1;case 1:return a.trys.push([1,5,,6]),t.info("LPC::Navigating to user's LinkedIn"),p=e.scenarios.people.lpcLinkedIn,[4,n.getPeopleProfile(i,p,!1)];case 2:return d=a.sent(),[4,r.getChatConversationWith(i)];case 3:return f=a.sent(),[4,s({groupName:d.displayName,slug:f.id,middlePane:e.peopleTab.panes.linkedin,ctx:e.navigation.context.chat})];case 4:return a.sent(),u&&u(!0),c(o.LpcCallbackTelemetryType.lpcLinkedIn,i),[3,6];case 5:return h=a.sent(),v="Failed to navigate to LinkedIn.",t.error(v),u&&u(!1,v),[3,6];case 6:return[2]}})})}},v=function(e,t,n){return function(r,s){return i(void 0,void 0,void 0,function(){var i,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Starting audio call"),[4,t(r.TeamsMri)];case 1:return a.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcAudioCall,r.TeamsMri),[3,3];case 2:return i=a.sent(),c="Failed to start audio call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},g=function(e,t,n){return function(r,s){return i(void 0,void 0,void 0,function(){var i,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Starting video call"),[4,t(r.TeamsMri,!0)];case 1:return a.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcVideoCall,r.TeamsMri),[3,3];case 2:return i=a.sent(),c="Failed to start video call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}};t.makeSendQuickMessage=function(e,t,n,r,s){return function(c,l,u){return i(void 0,void 0,void 0,function(){var i,p,d,f,h,v;return a(this,function(a){switch(a.label){case 0:if(i=c.TeamsMri)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),p=e.scenarios.people.lpcSendQuickMessage,[4,n.getAllShortPeopleProfile([c.Upn],p,!0,void 0,!0,void 0,!0)];case 2:return d=a.sent()[0],i=null===d||void 0===d?void 0:d.mri,[3,4];case 3:return f=a.sent(),v="Could not resolve user",t.error(v),u(!1,v),[2];case 4:return a.trys.push([4,6,,7]),t.info("LPC::Sending message to user, message length {0}",l&&l.length),[4,r(i,l)];case 5:return a.sent(),u(!0),s(o.LpcCallbackTelemetryType.lpcQuickIM,c.TeamsMri),[3,7];case 6:return h=a.sent(),v="Failed to send message",t.error(v),u(!1,v),[3,7];case 7:return[2]}})})}};var m=function(e,t,n,r,o,s,l,u,p){return function(d,f){return i(void 0,void 0,void 0,function(){var i,h,v,g,m,b,y,C,S,T;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,7,,8]),t.info("LPC::Blocking contact"),i=e.scenarios.people.lpcBlockContact,h=d.TeamsMri,v=p.valueAsBoolean(e.settings.names.enableTfwToTfwFederatedInviteFree),[4,s.getAllShortPeopleProfile([h],i,!1,void 0,!0,void 0,!1)];case 1:return g=a.sent()[0],m=o.isCurrentUserTFLOrMsaAccount(),b=g.type,(y=c.isMixedChatUserinTFW(b,m,e.userTypes.tflConsumer))&&(h=d.TeamsMri.replace("8:","8:tfl:")),[4,n.getConversationWithV2(h,"LivePersonaCard")];case 2:return(C=a.sent())?[4,l.acceptBlockChat(C.id,!1)]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,r.addBlockedMri(d.TeamsMri,"LivePersonaCard")];case 5:a.sent(),a.label=6;case 6:return f(!0),u(c.getBlockTelemetryType(m,b,v),h),[3,8];case 7:return S=a.sent(),T="Failed to block contact",t.error(T),f(!1,T),[3,8];case 8:return[2]}})})}},b=function(e,t,n,r,o,s,l,u){return function(p,d){return i(void 0,void 0,void 0,function(){var i,f,h,v,g,m,b,y,C,S;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,7,,8]),t.info("LPC::Unblocking contact"),i=e.scenarios.people.lpcUnblockContact,f=p.TeamsMri,h=u.valueAsBoolean(e.settings.names.enableTfwToTfwFederatedInviteFree),[4,s.getAllShortPeopleProfile([f],i,!1,void 0,!0,void 0,!1)];case 1:return v=a.sent()[0],g=o.isCurrentUserTFLOrMsaAccount(),m=v.type,(b=c.isMixedChatUserinTFW(m,g,e.userTypes.tflConsumer))&&(f=p.TeamsMri.replace("8:","8:tfl:")),[4,n.getConversationWithV2(f,"LivePersonaCard")];case 2:return(y=a.sent())?[4,n.acceptBlockChat(y.id,!0,"LivePersonaCard")]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,r.deleteBlockedMri(p.TeamsMri,"LivePersonaCard")];case 5:a.sent(),a.label=6;case 6:return d(!0),l(c.getUnblockTelemetryType(g,m,h),f),[3,8];case 7:return C=a.sent(),S="Failed to unblock contact",t.error(S),d(!1,S),[3,8];case 8:return[2]}})})}},y=function(e,t,n,r,s){return function(c,l){return i(void 0,void 0,void 0,function(){var i,u,p,d;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Edit Me Profile"),[4,r.getMeMSAProfile(n.scenarios.people.lpcEditProfile,!1)];case 1:return i=a.sent(),u=n.appHeaderBar.buttonid.profileButton,t.open(n.dialogs.updateUserProfile,{isFre:!1,preActiveElementIds:[u],user:i,isMSAEditNameClick:!0}),l(!0),s(o.LpcCallbackTelemetryType.lpcEditMeProfile,c.TeamsMri),[3,3];case 2:return p=a.sent(),d="Failed to edit me user profile",e.error(d),l(!1,d),[3,3];case 3:return[2]}})})}},C=function(e,t,n,r,s){if(n.valueAsBoolean(r.settings.names.enableManageAliasPrivacy))return function(n,c){return i(void 0,void 0,void 0,function(){var i;return a(this,function(a){try{e.info("LPC::Manage discoverability settings"),t.open(r.dialogs.manageAliasPrivacyDialog,{backButtonShouldOpenSettings:!0}),c(!0),s(o.LpcCallbackTelemetryType.lpcManageDiscoverabilitySettings,n.TeamsMri)}catch(t){i="Failed to manage discoverability settings",e.error(i),c(!1,i)}return[2]})})}},S=function(e,t,n,r){if(n.valueAsBoolean(r.settings.names.enableAliasVisibilitySettings))return function(n){try{e.info("LPC::Manage alias visibility settings"),t.open(r.dialogs.manageAliasVisibilityDialog,{backButtonShouldOpenSettings:!0,referrer:r.manageAliasVisibilityDialogReferrer.lpcMeProfileCard}),n(!0)}catch(t){var i="Failed to open the Manage alias visibility settings dialog";e.error(i),n(!1,i)}}},T=function(e,t,n,r){return function(s){return i(void 0,void 0,void 0,function(){var i,c,l;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Open meeting details"),i=s.replace(/\//g,"-"),[4,n.navigateToCalendarScheduleForm(t.dialogs.meetingDetail,{slug:i,eventId:i,providerType:services.CalendarEventProviderType.userEventUsingEventId,navCtx:t.navContext.livePersonaCard})];case 1:return a.sent(),r(o.LpcCallbackTelemetryType.lpcOpenMeetingDetails,i),[3,3];case 2:throw c=a.sent(),l="Error opening meeting details",e.error(l),l;case 3:return[2]}})})}};t.LPCActionCallbackFactory=function(e,n,r,i,a,o,s,c,k,P,w,A,I,L,O){var E=l(n,e,s),x=u(a,c),U=p(a,k);return{startChat:d(n,r,i,a,o,E,L),showOrgChart:f(n,r,i,E,L,O),showLinkedIn:h(n,r,i,a,E,L),sendQuickMessage:t.makeSendQuickMessage(n,r,i,U,L),startVideoCall:g(r,x,L),startAudioCall:v(r,x,L),blockContact:m(n,r,a,P,o,i,I,L,A),unblockContact:b(n,r,a,P,o,i,L,A),editMeProfile:y(r,w,n,i,L),manageDiscoverabilitySettings:C(r,w,A,n,L),openAliasVisibilitySettings:S(r,w,A,n),openMeetingAsync:T(r,n,s,L)}}},2360:function(e,t,n){"use strict";function r(e,t,n){return n&&!e&&t==i.PersonaType.Federated}Object.defineProperty(t,"__esModule",{value:!0});var i=n(138),a=n(37);t.isMixedChatUserinTFW=function(e,t,n){return!t&&i.getIsMixedChatUser(t,e)&&e===n},t.getBlockTelemetryType=function(e,t,n){return r(e,t,n)?a.LpcCallbackTelemetryType.lpcBlockTfwToTfwFederatedUser:a.LpcCallbackTelemetryType.lpcBlockContact},t.getUnblockTelemetryType=function(e,t,n){return r(e,t,n)?a.LpcCallbackTelemetryType.lpcUnblockTfwToTfwFederatedUser:a.LpcCallbackTelemetryType.lpcUnblockContact}},2361:function(e,t,n){"use strict";function r(e,t){return{disableChatFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartChatHeaderButton),disableOrgChartFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcOrgChartHeaderButton),disableVideoFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartVideoCallHeaderButton),disableAudioCallFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartAudioCallHeaderButton)}}function i(e){return e&&validator.isEmail(e)}function a(e,t,n){var r=this;return function(i,a,o){return l(r,void 0,void 0,function(){var r,a,s,c,l,p;return u(this,function(u){switch(u.label){case 0:r=t.service.newScenario(n.scenarios.people.lpcGetOrgChart),a=i.TeamsMri||i.Smtp||i.Upn,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e.getOrgChart(a,n.scenarios.people.lpcCallerName)];case 2:return(s=u.sent())?(c=f.getDirectReportsAndManager(s.value),r.stop(),o(c,void 0)):(p="No orgChart returned",t.error(p),r.stop({reason:p}),o(void 0,p)),[3,4];case 3:return l=u.sent(),p="Exception in orgChart call",t.error("getOrgChart failed in LPC data callback"),r.fail({reason:p}),o(void 0,p),[3,4];case 4:return[2]}})})}}function o(e,t,n,r,i,a,o){var s=this;return function(c,p,h){return l(s,void 0,void 0,function(){var s,l,p,v,g,m,b,y,C,S,T,k,P,w,A,I,L,O,x,U,M;return u(this,function(u){switch(u.label){case 0:s=t.service.newScenario(i.scenarios.people.lpcGetHeaderInfo),l=c.TeamsMri||c.Smtp||c.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),p=d.deserializeHostAppPersonaId(c.HostAppPersonaId),v=p.isSharedChannel,g=p.hostTenantId,m=p.hostConversationId,b=p.isExchangeOnlyContact,y=void 0,v?[4,e.getAllPeopleProfileForConversation([l],m,!1,i.scenarios.people.lpcGetHeaderInfoSC,void 0,v,g)]:[3,3];case 2:return y=u.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfoSC),[3,7];case 3:return b?[4,f.getPersonaProfileByContactId(c.OlsPersonaId,t,a,s,i.scenarios.people.lpcGetHeaderInfoEC)]:[3,5];case 4:return(y=u.sent())?[3,7]:[2,h(void 0,"No profile returned for exchange contact in LPC getHeaderInfoAndCardType callback")];case 5:return[4,e.getAllPeopleProfile([l],i.scenarios.people.lpcGetHeaderInfo,!Boolean(c.TeamsMri))];case 6:y=u.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfo),u.label=7;case 7:return(C=y[0])?(S=C,T=n.getCurrentSkypeMri(),k=T===c.TeamsMri,P=SkypeX.Services.ChatServiceUtils.isAnonymousUserMri(c.TeamsMri),w=d.determineCardTypeForTargetUser(S.role,S.type,k,P),A=r.valueAsBoolean(i.settings.names.showOnlySearchablePhonesAndEmailsInLPC),I=o.isCurrentUserTFLOrMsaAccount(),L=f.getIsMixedChatUser(I,S.type),O=v&&S.xtapUser?S.tenantName:void 0,x=E(w,S,A,L,O),s.stop(),h(x,void 0)):(M="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:M}),h(void 0,M)),[3,9];case 8:return U=u.sent(),M="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:M}),h(void 0,M),[3,9];case 9:return[2]}})})}}function s(e,t,n,r,i,a,o){var s=this;return function(c,p){return l(s,void 0,void 0,function(){var s,l,h,v,g,m,b,y,C,S,T,k,P,w,A,I,L,O,E,x,U,M;return u(this,function(u){switch(u.label){case 0:s=t.service.newScenario(r.scenarios.people.lpcGetPersonaInfo),l=c.TeamsMri||c.Smtp||c.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),h=d.deserializeHostAppPersonaId(c.HostAppPersonaId),v=h.isSharedChannel,g=h.hostTenantId,m=h.hostConversationId,b=h.isExchangeOnlyContact,y=void 0,v?[4,e.getAllPeopleProfileForConversation([l],m,!1,r.scenarios.people.lpcGetPersonaInfoSC,void 0,v,g)]:[3,3];case 2:return y=u.sent(),s.mark(r.scenarios.people.lpcGetPersonaInfoSC),[3,7];case 3:return b?[4,f.getPersonaProfileByContactId(c.OlsPersonaId,t,i,s,r.scenarios.people.lpcGetPersonaInfoEC)]:[3,5];case 4:return(y=u.sent())?[3,7]:[2,p(void 0,"No profile returned for exchange contact in LPC getPersonaInfo callback")];case 5:return[4,e.getAllPeopleProfile([l],r.scenarios.people.lpcGetPersonaInfo,!Boolean(c.TeamsMri))];case 6:y=u.sent(),s.mark(r.scenarios.people.lpcGetPersonaInfo),u.label=7;case 7:return(C=y[0])?(S=C,T=a.isCurrentUserTFLOrMsaAccount(),k=f.getIsMixedChatUser(T,S.type),P=T&&k,w=v&&!!S.xtapUser,A=k||w?S.tenantName:S.department,I=n.valueAsBoolean(r.settings.names.showOnlySearchablePhonesAndEmailsInLPC)&&!P,L=n.valueAsBoolean(r.settings.names.enableAliasVisibilitySettings),O=o.getCurrentSkypeMri(),E=O===c.TeamsMri,x={hostAppPersonaId:c.HostAppPersonaId,aadObjectId:S.objectId,email:L&&T&&E?void 0:f.getEmail(S,I),extraEmails:L?f.getVisibleEmails(S):f.getEmails(S,I),upn:S.userPrincipalName,userType:d.determineLPCPersonaType(S.role,S.type),displayName:S.displayName,firstName:S.givenName,lastName:S.surname,skypeId:S.skypeId,isInformationBarrierBarred:S.isIbBarred,teamsMri:c.TeamsMri||S.mri,jobTitle:S.jobTitle,department:A,officeLocation:S.userLocation,phoneNumbersAndUrls:L?f.getVisiblePhones(S):f.getPhoneNumbers(S,I),isMixedChatUser:k},s.stop(),p(x,void 0)):(M="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetPersonaInfo callback"),s.fail({reason:M}),p(void 0,M)),[3,9];case 8:return U=u.sent(),M="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetPersonaInfo callback"),s.fail({reason:M}),p(void 0,M),[3,9];case 9:return[2]}})})}}var c=this&&this.__assign||function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var p=n(37),d=n(320),f=n(138),h=n(13);t.convertHTMLEntities=function(e,t){return e=t.decodeHtml(e),e=t.replaceNewlines(e),e=e.replace(/=""/g,"")},t.unescapeHtmlEntities=function(e,n){if(!e)return e;var r=document.createElement("textarea"),i=(new DOMParser).parseFromString(e,"text/html").body.innerHTML.toString(),a=t.convertHTMLEntities(i,n);return r.textContent=a,r.value};var v=function(e,t,n,r,a){return function(o,s){return l(void 0,void 0,void 0,function(){var l,p,h,v,g,m,b,y,C,S,T,k,P,w;return u(this,function(u){switch(u.label){case 0:if(l=e.service.newScenario(n.scenarios.people.lpcGetImageUri),p=d.deserializeHostAppPersonaId(o.HostAppPersonaId),h=p.isSharedChannel,v=p.hostTenantId,g=p.hostConversationId,m=p.isExchangeOnlyContact,b={mri:o.TeamsMri,principalName:o.Upn||o.Smtp||o.TeamsMri,displayName:o.DisplayName||"",size:n.profilePictureSizes.medium},y=!1,C=i(b.principalName),S=h&&!C,o.DisplayName&&!S)return[3,9];T=o.TeamsMri||o.Smtp||o.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),k=void 0,h?[4,r.getAllPeopleProfileForConversation([T],g,!0,n.scenarios.people.lpcGetImageUriSC,void 0,h,v)]:[3,3];case 2:return k=u.sent(),l.mark(n.scenarios.people.lpcGetImageUriSC),[3,7];case 3:return m?[4,f.getPersonaProfileByContactId(o.OlsPersonaId,e,a,l,n.scenarios.people.lpcGetImageUriEC)]:[3,5];case 4:return k=u.sent(),[3,7];case 5:return[4,r.getAllShortPeopleProfile([T],n.scenarios.people.lpcGetImageUri,!Boolean(o.TeamsMri))];case 6:k=u.sent(),l.mark(n.scenarios.people.lpcGetImageUri),u.label=7;case 7:return(P=k[0])&&(b=c(c({},b),{displayName:P.displayName}),S&&(b=c(c({},b),{principalName:P.userPrincipalName})),P.isIbBarred&&(y=!0)),[3,9];case 8:return w=u.sent(),e.error("Failed to fetch persona profile in getAndPrefetchPersonaImageUri callback"),[3,9];case 9:return h&&(b=c(c({},b),{isSharedChannel:h,hostTenantId:v,conversationId:g})),m&&(b=c(c({},b),{isExchangeOnlyContact:m})),t.loadImage(b,!1,y,!1,h?n.scenarios.people.lpcGetImageUriSC:n.scenarios.people.lpcGetImageUri).then(function(e){var t=e&&e.imgUrl||"";l.stop(),s(t,{})}).catch(function(e){l.fail({reason:"Failed to fetch persona"}),s(void 0,void 0,e)}),[2]}})})}};t.getSkypeConsumerChatStatus=function(e,t,n,r){return l(void 0,void 0,void 0,function(){var i,a,o,s;return u(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,t.findConversationWith(n)];case 1:return(i=c.sent())&&i.isSfC()?(a=i.InteropConversationStatus())===e.interopConversationStatus.blocked?[2,p.PersonaPresence.blocked]:[2,p.PersonaPresence.none]:[2,void 0];case 2:return o=c.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(o),r.debug("getSkypeConsumerChatStatus(): Failed to get skype consumer chat status with error "+s),[2,void 0];case 3:return[2]}})})};var g=function(e,n,r,i,a,o,s){return l(void 0,void 0,void 0,function(){var c,l,d,f;return u(this,function(u){switch(u.label){case 0:return[4,t.getSkypeConsumerChatStatus(r,i,o,s)];case 1:if(void 0!==(c=u.sent()))return[2,c];if(l=a.isBlockedContact(o))return[2,p.PersonaPresence.blocked];if(d=e.status,f=e.flwPresence,n.valueAsBoolean(r.settings.names.enableFlwPresence)){if(f===SkypeX.Services.UserFlwPresence.OffShift)return[2,p.PersonaPresence.offline];if(f===SkypeX.Services.UserFlwPresence.OnShift)switch(d){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return[2,p.PersonaPresence.busy];default:return[2,p.PersonaPresence.online]}}switch(d){case SkypeX.Services.UserStatus.Online:return[2,p.PersonaPresence.online];case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return[2,p.PersonaPresence.offline];case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return[2,p.PersonaPresence.away];case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return[2,p.PersonaPresence.busy];case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return[2,p.PersonaPresence.dnd];default:return[2,p.PersonaPresence.offline]}return[2]}})})},m=function(e,t,n,r,i,a,o){if(!t||0===t.length)return e;var s=r.getLocalTimezone();if(n&&s!==n){var c=(new Date).toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),l=c.length>0?c[c.length-1]:null;l&&(t=a.instant(o.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:t,timeZoneCode:l}))}return a.instant(o.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:t})},b=function(e,t,n,r,i,a,o,s,c){var l=e.status,u=e.calendarData,p=e.lastSeenAt,d=e.flwPresence,f=e.extensions;if(t.valueAsBoolean(i.settings.names.enableFlwPresence)){if(d===SkypeX.Services.UserFlwPresence.OffShift)return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift);if(d===SkypeX.Services.UserFlwPresence.OnShift){var h=void 0,v=void 0,g=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(f);switch(g&&g.currentShift&&(h=c.getDate(new Date(g.currentShift.endTime),"shortTime"),v=g.currentShift.teamOlsonCode),l){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var b=r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return m(b,h,v,s,c,r,a);default:var y=n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return m(y,h,v,s,c,r,a)}}}var C=p&&(new Date).getTime()-p.getTime()<=i.timeInMiliseconds.year;if(u&&u.isOutOfOffice)switch(l){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return C?r.instant(a.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:o.transformIntoTimeago(p)}):n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);default:return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}else switch(l){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return C?r.instant(a.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:o.transformIntoTimeago(p)}):n.GetTranslatedStatusText(l);default:return n.GetTranslatedStatusText(l)}},y=function(e,t,n,r,i){var a="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(a=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),a},C=function(e,t,n,r,i,a){var o={message:"",publishTime:""};if(e.note){var s=e.note.message,c=e.note.publishTime;if(c&&c.trim()){var l=new Date(c);o.publishTime=a.getMessageDisplayableDateTime(l)}if(s){var u=r.stripHtml(i.sanitizeHtml(s)).trim(),p=y(e,0,0,r,i);u.length&&!p.length&&(o.message=u)}}return o.message&&o.publishTime?o:void 0},S=function(e,n,r,i){var a=[],o=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===n.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=r.DomUtils.getText(i),c=e.decodeHtml(i.attribs["data-itemprops"]),l=f.removeZeroWidthSpace(c),u=JSON.parse(l).mri;a.push({text:t.unescapeHtmlEntities(s,e),hostAppPersonaId:u,mri:u})}else"text"===i.type?a.push({text:t.unescapeHtmlEntities(r.DomUtils.getText(i),e),hostAppPersonaId:void 0}):"br"===i.name?a.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&o(i.children)})};return o(i),a},T=function(e,t,n,r,i,a){if(t.valueAsBoolean(n.settings.names.enableStatusNoteV2)&&e.note){var o={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var l=i.sanitizeHtml(s).trim(),u=window.htmlparser2,p=u.parseDOM("<div>"+l+"</div>"),d=S(r,n,u,p);o.message=d}if(c&&c.trim()){var f=new Date(c);o.publishTime=a.getMessageDisplayableDateTime(f)}return o.message.length&&o.publishTime?o:void 0}},k=function(e,t,n,r,i,a,o,s,c,p,d,f,h,v,m){return function(S,k){return l(void 0,void 0,void 0,function(){var l,P,w;return u(this,function(u){switch(u.label){case 0:return l=e.getPresence(S,k),w={},[4,g(l,i,a,h,v,S,m)];case 1:return w.presence=u.sent(),w.isOutOfOffice=l&&!!l.calendarData&&!!l.calendarData.isOutOfOffice,w.oofMessage=l&&y(l,0,0,t,n),w.presenceText=l&&b(l,i,o,s,a,c,p,d,f),w.statusNote=l&&C(l,0,0,t,n,r),w.statusNoteV2=l&&T(l,i,a,t,n,r),P=w,[2,P]}})})}},P=function(e,t,n,r){return function(i){return l(void 0,void 0,void 0,function(){var a,o,s,c,l,p;return u(this,function(u){switch(u.label){case 0:a=t.getRootRouteParams(),o=a&&a.ctx===n.navigation.context.chat&&a.slug,u.label=1;case 1:return u.trys.push([1,6,,7]),o?[4,e.getConversation(a.slug)]:[3,3];case 2:(s=u.sent())&&!s.isOneOnOne()&&(s=void 0),u.label=3;case 3:return(c=s)?[3,5]:[4,e.findConversationWith(i)];case 4:c=u.sent(),u.label=5;case 5:return(s=c)&&s.isInteropChat()?[2,Promise.resolve(SkypeX.Services.PresenceSource.SFB)]:[2,Promise.resolve(SkypeX.Services.PresenceSource.UPS)];case 6:return l=u.sent(),p=teamspace.services.AppsServiceUtils.getSafeError(l),r.debug("getPresenceSourceInternal(): Failed to get presence with error "+p),[2,Promise.resolve(SkypeX.Services.PresenceSource.UPS)];case 7:return[2]}})})}},w=function(e,t,n,r,i,a,o,s,c,p,f,h,v,g,m,b){return function(y,C){return l(void 0,void 0,void 0,function(){var l,S,T,w,A,I,L,O;return u(this,function(u){switch(u.label){case 0:if(l=d.deserializeHostAppPersonaId(y.HostAppPersonaId).isExchangeOnlyContact)return[2,C(null,void 0)];S=b.service.newScenario(o.scenarios.people.lpcGetRichPresence),u.label=1;case 1:return u.trys.push([1,4,,5]),T=P(e,m,o,b),w=k(t,n,r,i,a,o,s,c,p,f,h,v,e,g,b),[4,T(y.TeamsMri)];case 2:return A=u.sent(),[4,w(y.TeamsMri,A)];case 3:return I=u.sent(),S.stop(),C(I,void 0),[3,5];case 4:return L=u.sent(),S.fail(),O=teamspace.services.AppsServiceUtils.getSafeError(L),C(void 0,"getPresenceCallback(): Failed to execute presence callback with error "+O),[3,5];case 5:return[2]}})})}},A=function(e,t,n,i,a,o,s,c,p,v,g,m,b,y){return function(C){return l(void 0,void 0,void 0,function(){var l,S,T,k,P,w,A,L,O,E,x,U,M,F,B,D,_,j,N,R,H,G,V,X,z,W,q,Q,K,J,$,Z,Y,ee,te,ne,re,ie,ae,oe,se,ce,le,ue,pe,de,fe,he,ve;return u(this,function(u){switch(u.label){case 0:return l=i.service.newScenario(a.scenarios.people.lpcGetHeaderActionsPolicy),S=p.getCurrentSkypeMri(),T=S===C.TeamsMri,k=m.valueAsBoolean(a.settings.names.msgEnableSelfChat),P=m.valueAsBoolean(a.settings.names.enableExpandedViewInLPC),w=d.deserializeHostAppPersonaId(C.HostAppPersonaId),A=w.isSharedChannel,L=w.hostTenantId,O=w.hostConversationId,E=w.isExchangeOnlyContact,T&&!k||E?(T?l.stop({reason:"User is me"}):l.stop({reason:"Out-of-tenant outlook Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0,disableLinkedIn:!P}]):[4,y.isPersonReachable(C.TeamsMri)];case 1:if(x=!u.sent())return l.stop({reason:"ED only policy enabled, but user is not in Extended Directory"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0,disableLinkedIn:!0}];U=!c.isCurrentUserTFLOrMsaAccount(),M={disableChat:!1,disableOrg:!0,disableCall:!1,disableVideo:!1,disableBlockUnblock:U,disableLinkedIn:!0},F=s.isBlockedContact(C.TeamsMri),B=r(m,a),D=B.disableChatFromKillSwitch,_=B.disableOrgChartFromKillSwitch,j=B.disableVideoFromKillSwitch,N=B.disableAudioCallFromKillSwitch,R=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),M.disableCall=N||!R||T,M.disableVideo=j||!R||T,H=t.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),G=b.getSettingValue(SkypeX.Services.TenantSettingsStorageKey.isOrganizationTabEnabled),u.label=2;case 2:return u.trys.push([2,13,,14]),V=void 0,A?[4,n.getAllPeopleProfileForConversation([C.TeamsMri],O,!1,a.scenarios.people.lpcGetHeaderActionsPolicySC,void 0,A,L)]:[3,4];case 3:return V=u.sent(),l.mark(a.scenarios.people.lpcGetHeaderActionsPolicySC),[3,6];case 4:return[4,n.getAllPeopleProfile([C.TeamsMri],a.scenarios.people.lpcGetHeaderActionsPolicy,!C.TeamsMri)];case 5:V=u.sent(),l.mark(a.scenarios.people.lpcGetHeaderActionsPolicy),u.label=6;case 6:if(!(X=V[0]))return[3,12];if(z=X.featureSettings,W=X.type,q=X.userType,Q=X.isAnonymousUser,K=X.mri,J=X.isIbBarred,$=X.isFederated,Q||J)return Q?l.stop({reason:"Anonymous User"}):l.stop({reason:"IB Barred User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0,disableLinkedIn:!0}];if(Z=c.isCurrentUserTFLOrMsaAccount(),Y=f.getIsMixedChatUser(Z,X.type),ee=X.type===f.PersonaType.SkypeConsumer,te=m.valueAsBoolean(a.settings.names.enableTfwToTfwFederatedInviteFree),ne=!f.shouldEnableBlockUnblock({isMe:T,isAnonymousUser:Q,isLoggedInUserConsumer:Z,personaProfile:X,isTfwToTfwFederatedInviteFreeEnabled:te}),M.disableBlockUnblock=ne,F)return l.stop({reason:"Blocked Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:ne,disableLinkedIn:!0}];if(re=m.valueAsBoolean(a.settings.names.enableExtendedDirectory)){if(h.PeopleUtilities.isPendingExtendedDirectoryUser(null===X||void 0===X?void 0:X.userType,a))return l.stop({reason:"Pending Extended Directory user"}),[2,I({disableChat:!1,disableOrg:!0,disableCalling:!0,disableBlockUnblock:!0,disableLinkedIn:!0,settingsService:m,constants:a,messagingPolicySettingsStore:t,featureSettings:z})];if(h.PeopleUtilities.isAcceptedExtendedDirectoryUser(null===X||void 0===X?void 0:X.userType,a))return l.stop({reason:"Extended Directory user"}),[2,I({disableChat:!1,disableOrg:!0,disableCalling:!1,disableBlockUnblock:!0,disableLinkedIn:!0,settingsService:m,constants:a,messagingPolicySettingsStore:t,featureSettings:z})]}return ee?[2,I({disableChat:!1,disableOrg:!0,disableCalling:!1,disableBlockUnblock:!1,disableLinkedIn:!P,settingsService:m,constants:a,messagingPolicySettingsStore:t,featureSettings:z})]:Y?[2,I({disableChat:!1,disableOrg:!0,disableCalling:!0,disableBlockUnblock:!1,disableLinkedIn:!P,settingsService:m,constants:a,messagingPolicySettingsStore:t,featureSettings:z})]:(ie=SkypeX.Services.ChatServiceUtils.isPstnMri(K))?(l.stop({reason:"PSTN User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:N||!1,disableVideo:!0,disableBlockUnblock:!0,disableLinkedIn:!0}]):(ae=z&&z.isPrivateChatEnabled,oe=W&&W.toLowerCase()===a.userTypes.person.toLowerCase(),se=q&&q.toLowerCase()===a.userTypes.guest.toLowerCase(),ce=o===teamspace.services.UserTypeInTenant.Guest,le=SkypeX.Services.ChatServiceUtils.isSFBMri(K),ue=$||W&&W.toLowerCase()===a.userTypes.federated.toLowerCase(),M.disableChat=D||!1===ae||!H,M.disableOrg=_||!(oe&&!se)||ce||!G,M.disableLinkedIn=(ue||le)&&!P,M.disableChat?[3,11]:[4,v.getChatConversationWith(K)]);case 7:if(!(pe=u.sent())||SkypeX.Services.SkypeConversationLocal.isLie(pe.id))return[3,11];u.label=8;case 8:return u.trys.push([8,10,,11]),[4,g.validateUpgradePolicyOfChatRecipient(pe.id,!1)];case 9:return de=u.sent(),fe=de&&de.isValidChat,M.disableChat=!fe,[3,11];case 10:return he=u.sent(),i.error("Failed to validate chat in LPC data callbacks"),[3,11];case 11:l.stop(),u.label=12;case 12:return[3,14];case 13:return ve=u.sent(),l.fail({reason:"Error while fetching persona"}),i.error("Failed to fetch persona profile in LPC data callbacks"),[3,14];case 14:return[2,M]}})})}},I=function(e){var t=e.disableChat,n=e.disableOrg,i=e.disableCalling,a=e.disableBlockUnblock,o=e.disableLinkedIn,s=e.settingsService,c=e.constants,l=e.messagingPolicySettingsStore,u=e.featureSettings,p=r(s,c),d=p.disableChatFromKillSwitch,f=p.disableOrgChartFromKillSwitch,h=p.disableVideoFromKillSwitch,v=p.disableAudioCallFromKillSwitch,g=l.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),m=null===u||void 0===u?void 0:u.isPrivateChatEnabled;return{disableChat:t||Boolean(d)||!g||!1===m,disableOrg:t||n||Boolean(f),disableCall:i||Boolean(v),disableVideo:i||Boolean(h),disableBlockUnblock:a,disableLinkedIn:t||o}},L=function(e,t,n,r,i){var a=f.getEmail(t,n);return{cardType:e,headerInfo:{userHeaderInfo:{displayName:t.displayName,firstName:t.givenName,lastName:t.surname,title:t.jobTitle,department:r?t.tenantName:t.department,location:t.userLocation,profilePictureUrl:t.imageUri,mobilePhone:t.mobile,phone:f.getPhoneNumber(t,n),userPrincipalName:t.userPrincipalName,email:a&&a.Address,imAddress:t.skypeId,tenantName:i},isMixedChatUser:r}}},O=function(e,t){return{cardType:e,headerInfo:{unresolvedHeaderInfo:{email:t}}}},E=function(e,t,n,r,i){return"NotResolved"===e?O(e,t.email):L(e,t,n,r,i)};t.makeGetHeaderInfoAndCardTypeCallback=o,t.GetPresenceSourceFunction=P,t.GetRichPresenceFunction=k,t.LPCDataCallbackFactory=function(e,t,n,r,i,c,l,u,p,d,f,h,g,m,b,y,C,S,T,k,P,I,L,O,E,x,U){return{getAndPrefetchPersonaImageUri:v(e,y,p,r,E),getRichPresence:w(t,n,i,c,l,u,p,d,f,h,g,m,b,C,L,e),getHeaderActionsPolicyAsync:A(S,T,r,e,p,k,C,I,P,t,O,u,x,U),getPersonaInfo:s(r,e,u,p,E,I,P),getOrgChart:a(r,e,p),getHeaderInfoAndCardType:o(r,e,P,u,p,E,I)}}},2362:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return function(t,n){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.newSecondPartyOneDsLogger(t,n),[2]})})}},o=function(e){return function(t,n){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.logSecondPartyEvent(t,n),[2]})})}};t.LPCTelemetryCallbackFactory=function(e){return{initializeExternalOneDsTelemetry:a(e),sendExternalOneDsTelemetryEvent:o(e)}}},2363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2364);t.defaultTheme=r.defaultTheme;var i=n(2365);t.darkTheme=i.darkTheme;var a=n(2366);t.highContrastTheme=a.highContrastTheme},2364:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),i="rgba(37,36,36,0.75)",a={themeDarker:"#34365c",themePrimary:i,themeSecondary:i,neutralPrimary:"#252424",neutralSecondary:i,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",purple:"#5B5FC7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)",purpleLight:"#E5E5F1",purpleDark:"#6264a7",neutralDark:"#616161"};t.defaultTheme={palette:a,isInverted:!1,themeName:r.LPCTheme.Default}},2365:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37);t.fontColor="rgba(255,255,255,0.75)",t.white="#2d2c2c",t.darkThemePalette={themeDarker:"#C5CBFA",themePrimary:t.fontColor,themeSecondary:t.fontColor,neutralPrimary:"#ffffff",neutralSecondary:t.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:t.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:t.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:t.white,purple:"#9399f5",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff",purpleLight:"#3D3E66",purpleDark:"#9ea2ff",neutralDark:"#D1D1D1"},t.darkTheme={palette:t.darkThemePalette,isInverted:!0,themeName:r.LPCTheme.Dark}},2366:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),i="#000000",a="#ffffff",o={themeDarker:"#ffff73",themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:a,neutralSecondary:"#ffffff",neutralLight:i,neutralLighter:a,neutralLighterAlt:a,neutralPrimaryAlt:i,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:i,neutralQuaternary:i,neutralQuaternaryAlt:a,white:i,black:a,purple:"#ffff00",magenta:a,magentaDark:i,purpleLight:"#ffff01",purpleDark:"#000",neutralDark:"#fff"};t.highContrastTheme={palette:o,isInverted:!0,themeName:r.LPCTheme.HighContrast}},2367:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a,o=teamspace.components.PanelActionGesture,s=teamspace.components.PanelActionOutcome,c=teamspace.components.PanelActionScenario,l=teamspace.components.PanelActionScenarioType,u=teamspace.components.PanelModuleName,p=teamspace.components.PanelModuleType,d=teamspace.components.WorkLoad,f=teamspace.components.SubWorkLoad,h=teamspace.PanelType,v=n(37);!function(e){e.TFWUser="TFWUser"}(a||(a={}));var g=function(){function e(e,t,n){this.analyticsService=e,this.loggingService=t,this.conversationsAsyncService=n}return e.prototype.logPanelActionEvent=function(e,t){return r(this,void 0,void 0,function(){var n,r,g,m,b,y,C,S,T,k,P,w,A,I,L,O,E=this;return i(this,function(i){switch(i.label){case 0:switch(y=p.people,S=s.nav,T=s.nav,k=teamspace.PanelRegion.popover,P=d.chatContent,w=f.composeMsg,e){case v.LpcCallbackTelemetryType.lpcAudioCall:r=o.click,g=c.navCalling,m=u.lpcAudioCall,n="lpcAudioCall";break;case v.LpcCallbackTelemetryType.lpcStartChat:r=o.click,g=c.navChat,m=u.lpcStartChat,n="lpcStartChat";break;case v.LpcCallbackTelemetryType.lpcOrgChart:r=o.click,g=c.orgChart,m=u.lpcOrgChart,n="lpcOrgChart";break;case v.LpcCallbackTelemetryType.lpcOpenMeetingDetails:r=o.click,g=c.navMeetings,m=u.viewMeeting,n="lpcOpenMeeting";break;case v.LpcCallbackTelemetryType.lpcQuickIM:r=o.click,S=s.submit,T=s.submit,g=c.quickIM,m=u.lpcQuickIM,b=u.sendButton,C=p.compose,n="lpcQuickIM";break;case v.LpcCallbackTelemetryType.lpcVideoCall:r=o.click,g=c.navCalling,m=u.lpcVideoCall,n="lpcVideoCall";break;case v.LpcCallbackTelemetryType.lpcBlockContact:r=o.click,g=c.blockUser,m=u.lpcBlockContact,n="lpcBlockContact";break;case v.LpcCallbackTelemetryType.lpcUnblockContact:r=o.click,g=c.unblockUser,m=u.lpcUnblockContact,n="lpcUnblockContact";break;case v.LpcCallbackTelemetryType.lpcLinkedIn:r=o.click,g=c.navLinkedIn,m=u.lpcLinkedIn,n="lpcLinkedIn";break;case v.LpcCallbackTelemetryType.lpcBlockTfwToTfwFederatedUser:g=c.blockUser,m=u.lpcBlockContact,y=p.blockButton,S=s.submit,r=o.click,P=void 0,w=void 0,I=h.livePersonaCard,A={userTypeSelected:a.TFWUser,hasAADFederatedMembers:!0};break;case v.LpcCallbackTelemetryType.lpcUnblockTfwToTfwFederatedUser:g=c.unblockUser,m=u.lpcUnblockContact,y=p.unblockButton,S=s.submit,r=o.click,P=void 0,w=void 0,I=h.livePersonaCard,A={userTypeSelected:a.TFWUser,hasAADFederatedMembers:!0};break;default:return[2]}return O={action:{gesture:r,outcome:S,outcomeNew:T,scenario:g||null,scenarioType:l.people,workLoad:P||null,subWorkLoad:w||null},module:{name:(null===m||void 0===m?void 0:m.toString())||null,nameNew:b?teamspace.shared.AttributeHelper.tryGetEnum(b.toString(),u,this.loggingService):null,type:y||null,typeNew:C?teamspace.shared.AttributeHelper.tryGetEnum(C.toString(),p,this.loggingService):null,summary:n},panel:{type:I?h[I]:null}},[4,this.getTargetThreadType(t)];case 1:return O.targetThread=i.sent(),O.dataBag=A,L=O,this.analyticsService.getAnalyticsPanelActionEventData(L,k).then(function(e){E.analyticsService.sendPanelAction(e)}),[2]}})})},e.prototype.getTargetThreadType=function(e){return r(this,void 0,void 0,function(){var t,n,r,a;return i(this,function(i){switch(i.label){case 0:if(!e)return[2,null];t="OneOnOneChat",i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.conversationsAsyncService.getConversation(e)];case 2:return n=i.sent(),t=n&&n.conversationType||t,[3,5];case 3:return r=i.sent(),a=teamspace.services.AppsServiceUtils.getSafeError(r),this.loggingService.error("getTargetThreadType(): Failed to get conversation with error "+JSON.stringify(a)),[3,5];case 4:return[2,{type:t}];case 5:return[2]}})})},e}();t.LpcTelemetryHelper=g},320:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.determineLPCPersonaType=function(e,t){switch(t){case"Federated":case"SkypeConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.determineCardTypeForTargetUser=function(e,t,n,r){if(n)return"Me";if(r)return"External";switch(t){case"Federated":case"SkypeConsumer":case"TflConsumer":return"External";case"person":case"ADUser":return"Guest"===e?"Guest":"User";default:return"User"}},t.getCleanUpn=function(e){return!e||SkypeX.Services.ChatServiceUtils.isMri(e)?void 0:e},t.serializeHostAppPersonaId=function(e){return JSON.stringify(e)},t.isLinkedInEnabled=function(e,t){var n=e.valueAsBoolean(t.settings.names.enableLinkedInTab),r=e.valueAsBoolean(t.settings.names.enableLinkedInInLPC);return n&&r},t.isLinkedInPanelEnabled=function(e,t){var n=e.valueAsBoolean(t.settings.names.enableLinkedInTab),r=e.valueAsBoolean(t.settings.names.enableLinkedInPanelInLPC);return n&&r},t.deserializeHostAppPersonaId=function(e){if(!e)return{userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0,isExchangeOnlyContact:!1};var t=JSON.parse(e);return{userId:t.userId,isSharedChannel:!0===t.isSharedChannel,hostTenantId:t.hostTenantId,hostConversationId:t.hostConversationId,isExchangeOnlyContact:!0===t.isExchangeOnlyContact}},t.getTimeFormat=function(e){var t=e.getDateFormatValue("shortTime",!1);return"HH:mm"===t?[t,!0]:[t,!1]}},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e.Default="default",e.HighContrast="contrast",e.Dark="dark",e.DefaultV2="defaultV2",e.DarkV2="darkV2"}(t.TeamsTheme||(t.TeamsTheme={}));!function(e){e.Default="default",e.Dark="dark",e.HighContrast="contrast"}(t.LPCTheme||(t.LPCTheme={}));!function(e){e[e.lpcAudioCall=0]="lpcAudioCall",e[e.lpcStartChat=1]="lpcStartChat",e[e.lpcEditMeProfile=2]="lpcEditMeProfile",e[e.lpcOrgChart=3]="lpcOrgChart",e[e.lpcOpenMeetingDetails=4]="lpcOpenMeetingDetails",e[e.lpcLinkedIn=5]="lpcLinkedIn",e[e.lpcQuickIM=6]="lpcQuickIM",e[e.lpcVideoCall=7]="lpcVideoCall",e[e.lpcBlockContact=8]="lpcBlockContact",e[e.lpcUnblockContact=9]="lpcUnblockContact",e[e.lpcManageDiscoverabilitySettings=10]="lpcManageDiscoverabilitySettings",e[e.personImageCallback=11]="personImageCallback",e[e.richPresenceCallback=12]="richPresenceCallback",e[e.lpcUnblockTfwToTfwFederatedUser=13]="lpcUnblockTfwToTfwFederatedUser",e[e.lpcBlockTfwToTfwFederatedUser=14]="lpcBlockTfwToTfwFederatedUser"}(t.LpcCallbackTelemetryType||(t.LpcCallbackTelemetryType={}));!function(e){e.Public="Public",e.Private="Private"}(t.AliasVisibility||(t.AliasVisibility={}))}},[2356]);